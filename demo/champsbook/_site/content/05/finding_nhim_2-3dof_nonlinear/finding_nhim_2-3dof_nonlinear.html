<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Finding NHIM using LD: 2 and 3 DoF nonlinear Hamiltonian</title>
  <meta name="description" content="__Abstract__We present the capability of Lagrangian descriptors for revealing the high dimensional phase space structures that are of interest in nonlinear H...">

  <link rel="canonical" href="http://localhost:4445/content/05/finding_nhim_2-3dof_nonlinear/finding_nhim_2-3dof_nonlinear.html">
  <link rel="alternate" type="application/rss+xml" title="CHAMPS Dynamical Systems Book" href="http://localhost:4445/feed.xml">

  <meta property="og:url"         content="http://localhost:4445/content/05/finding_nhim_2-3dof_nonlinear/finding_nhim_2-3dof_nonlinear.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Finding NHIM using LD: 2 and 3 DoF nonlinear Hamiltonian" />
<meta property="og:description" content="__Abstract__We present the capability of Lagrangian descriptors for revealing the high dimensional phase space structures that are of interest in nonlinear H..." />
<meta property="og:image"       content="http://localhost:4445/images/logo/champs_logo.jpg" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "http://localhost:4445/content/05/finding_nhim_2-3dof_nonlinear/finding_nhim_2-3dof_nonlinear.html",
  "headline": "Finding NHIM using LD: 2 and 3 DoF nonlinear Hamiltonian",
  "datePublished": "2019-12-04T12:58:40+00:00",
  "dateModified": "2019-12-04T12:58:40+00:00",
  "description": "__Abstract__We present the capability of Lagrangian descriptors for revealing the high dimensional phase space structures that are of interest in nonlinear H...",
  "author": {
    "@type": "Person",
    "name": "The CHAMPS group"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:4445",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "http://localhost:4445",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/assets/css/styles.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    },
    
    // Number LaTeX-style equations
    "TeX": {
        equationNumbers: {
          autoNumber: "all"
        }
    }
    
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML' async></script>


  <!-- DOM updating function -->
  <script src="/assets/js/page/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/assets/js/page/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/assets/js/page/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


<!-- Display Thebelab button in each code cell -->
<script>
/**
 * Set up thebelab button for code blocks
 */

const thebelabCellButton = id =>
  `<a id="thebelab-cell-button-${id}" class="btn thebebtn o-tooltip--left" data-tooltip="Interactive Mode">
    <img src="/assets/images/edit-button.svg" alt="Start thebelab interactive mode">
  </a>`


const addThebelabButtonToCodeCells =  () => {

  const codeCells = document.querySelectorAll('div.input_area > div.highlight:not(.output) pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.getElementById("thebelab-cell-button-" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', thebelabCellButton(id));
    }
  })
}

initFunction(addThebelabButtonToCodeCells);
</script>



<script type="text/x-thebe-config">
    
    {
      requestKernel: true,
      binderOptions: {
        repo: 'jupyter/jupyter-book',
        ref: 'gh-pages',
      },
      codeMirrorConfig: {
        theme: "abcdef",
        mode: "python"
      },
      kernelOptions: {
        name: 'python3',
      }
    }
</script>
<script src="https://unpkg.com/thebelab@latest/lib/index.js" async></script>
<script>
    /**
     * Add attributes to Thebelab blocks
     */

    const initThebelab = () => {
        const addThebelabToCodeCells = () => {
            console.log("Adding thebelab to code cells...");
            // If Thebelab hasn't loaded, wait a bit and try again. This
            // happens because we load ClipboardJS asynchronously.
            if (window.thebelab === undefined) {
                setTimeout(addThebelabToCodeCells, 250)
            return
            }

            // If we already detect a Thebelab cell, don't re-run
            if (document.querySelectorAll('div.thebelab-cell').length > 0) {
                return;
            }

            // Find all code cells, replace with Thebelab interactive code cells
            const codeCells = document.querySelectorAll('.input_area pre')
            codeCells.forEach((codeCell, index) => {
                const id = codeCellId(index)
                codeCell.setAttribute('data-executable', 'true')

                // Figure out the language it uses and add this too
                var parentDiv = codeCell.parentElement.parentElement;
                var arrayLength = parentDiv.classList.length;
                for (var ii = 0; ii < arrayLength; ii++) {
                    var parts = parentDiv.classList[ii].split('language-');
                    if (parts.length === 2) {
                        // If found, assign dataLanguage and break the loop
                        var dataLanguage = parts[1];
                        break;
                    }
                }
                codeCell.setAttribute('data-language', dataLanguage)

                // If the code cell is hidden, show it
                var inputCheckbox = document.querySelector(`input#hidebtn${codeCell.id}`);
                if (inputCheckbox !== null) {
                    setCodeCellVisibility(inputCheckbox, 'visible');
                }
            });

            // Remove the event listener from the page so keyboard press doesn't
            // Change page
            document.removeEventListener('keydown', initPageNav)
            keyboardListener = false;

            // Init thebelab
            thebelab.bootstrap();

            // Remove copy buttons since they won't work anymore
            const copyAndThebeButtons = document.querySelectorAll('.copybtn, .thebebtn')
            copyAndThebeButtons.forEach((button, index) => {
                button.remove();
            });

            // Remove outputs since they'll be stale
            const outputs = document.querySelectorAll('.output *, .output')
            outputs.forEach((output, index) => {
                output.remove();
            });

            // Find any cells with an initialization tag and ask ThebeLab to run them when ready
            var thebeInitCells = document.querySelectorAll('div.tag_thebelab-init');
            thebeInitCells.forEach((cell) => {
                console.log("Initializing ThebeLab with cell: " + cell.id);
                cell.querySelector('.thebelab-run-button').click();
            });
        }

        // Add event listener for the function to modify code cells
        const thebelabButtons = document.querySelectorAll('[id^=thebelab], [id$=thebelab]')
        thebelabButtons.forEach((thebelabButton,index) => {
            if (thebelabButton === null) {
                setTimeout(initThebelab, 250)
                return
            };
            thebelabButton.addEventListener('click', addThebelabToCodeCells);
        });
    }

    // Initialize Thebelab
    initFunction(initThebelab);
</script>



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.8.1/tocbot.min.js" async></script>
  <script src="/assets/js/page/tocbot.js"></script>

  <!-- Google analytics -->
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-52617120-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-52617120-7');
</script>



  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("http://localhost:4445") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" async></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/assets/js/page/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/assets/js/page/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/assets/css/styles.css",
        style: "#textbook_content {padding-top: 40px};",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList,
        documentTitle: "Made with Jupyter Book"
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://champsproject.com"><img src="/images/logo/champs_logo.jpg" class="textbook_logo" id="sidebar-logo" alt="textbook logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">CHAMPS Dynamical Systems Book</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/01/ham_bif_html-captions">
        <a class="c-sidebar__entry"
          href="/01/ham_bif_html-captions.html"
        >
          
            1.
          
          Dynamical Systems Concepts
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/02/booksprinttest_makrina_new3">
        <a class="c-sidebar__entry"
          href="/02/booksprinttest_makrina_new3.html"
        >
          
            2.
          
          Exploring Isomerization Dynamics on a four well Potential
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/03/Draft_new3">
        <a class="c-sidebar__entry"
          href="/03/Draft_new3.html"
        >
          
            3.
          
          Rafa chapter
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/04/test">
        <a class="c-sidebar__entry"
          href="/04/test.html"
        >
          
            4.
          
          Vladi chapter
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/05/quad-normal-form/quad-normal-form_new3">
        <a class="c-sidebar__entry"
          href="/05/quad-normal-form/quad-normal-form_new3.html"
        >
          
            5.
          
          Finding NHIM using LD N DoF quadratic normal form Hamiltonian
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/06/caldera-1_new3">
        <a class="c-sidebar__entry"
          href="/06/caldera-1_new3.html"
        >
          
            6.
          
          Dynamical Matching in a Caldera Potential energy surface
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/test_page">
        <a class="c-sidebar__entry"
          href="/test_page.html"
        >
          
            7.
          
          Writing LaTeX-like in Jupyter
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/contributing">
        <a class="c-sidebar__entry"
          href="/contributing.html"
        >
          
          Contributing to Jupyter Book
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="https://github.com/broncio123/champs-booksprint-planning">
        <a class="c-sidebar__entry"
          href="https://github.com/broncio123/champs-booksprint-planning"
        >
          
          GitHub repository
        </a>
      </li>

      
      

      

      
      

      

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://jupyterbook.org">Jupyter Book</a></p>
</nav>

      
      <div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <div class="c-topbar__buttons">
    <button
      id="js-sidebar-toggle"
      class="hamburger hamburger--arrowalt is-active"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="buttons">
<div class="download-buttons-dropdown">
    <button id="dropdown-button-trigger" class="interact-button"><img src="/assets/images/download-solid.svg" alt="Download" /></button>
    <div class="download-buttons">
        
        <a id="interact-button-print"><button id="interact-button-download" class="interact-button">.pdf</button></a>
    </div>
</div>


</div>

  </div>
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="sidebar__right">
    <header><h4 class="nav__title"><img src="/assets/images/list-solid.svg" alt="Search" />   On this page</h4></header>
    <nav class="onthispage">
    </nav>
  </aside>
  <a href="/search.html" class="topbar-right-button" id="search-button">
    <img src="/assets/images/search-solid.svg" alt="Search" />
  </a>
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
              <p><strong>Abstract</strong></p>

<p>We present the capability of Lagrangian descriptors for revealing the high 
dimensional phase space structures that are of interest in nonlinear Hamiltonian systems with index-1 saddle. These phase space structures include normally hyperbolic invariant manifolds (NHIM) and their stable and unstable manifolds, and act as codimenision-1 barriers to phase space transport. The method is applied to classical two and three degrees-of-freedom Hamiltonian systems which have implications for myriad applications in physics and chemistry.</p>

<h2 id="introduction">Introduction</h2>

<p>It is well-known now that the paradigm of escape from a potential well
and the topology of phase space structures that mediate such escape are
used in a broad array of problems such as isomerization of molecular
clusters [@Komatsuzaki2001], reaction rates in chemical
physics [@Komatsuzaki1999; @WiWiJaUz2001], ionization of a hydrogen atom
under electromagnetic field in atomic physics [@JaFaUz2000], transport
of defects in solid state and semiconductor physics [@Eckhardt1995],
buckling modes in structural mechanics [@Collins2012; @ZhViRo2018], ship
motion and capsize [@Virgin1989; @ThDe1996; @NaRo2017], escape and
recapture of comets and asteroids in celestial
mechanics [@JaRoLoMaFaUz2002; @DeJuLoMaPaPrRoTh2005; @Ross2003], and
escape into inflation or re-collapse to singularity in
cosmology [@DeOliveira2002]. As such a method that can identify the high
dimensional phase space structures using low dimensional surface as
probes can aid in quantifying the escape rates. These low dimensional
surfaces has been shown to be of as <em>reactive islands</em> in chemical
physics and lead to insights into sampling rare transition
events [@patra_classical-quantum_2015; @patra_detecting_2018]. However,
to benchmark the methodology, we first applied it to linear systems
where the closed-form analytical expression of the phase space
structures is known [@naik2019finding]. As the next step, in this
article, we will focus on nonlinear Hamiltonian systems which have been
extensively studied as “built by hand” models of galactic dynamics and
for demonstrating quantum dynamical
tunneling [@barbanis_isolating_1966; @brumer_variational_1976; @davis_semiclassical_1979; @heller_molecular_1980; @waite_mode_1981; @kosloff_dynamical_1981; @contopoulos_simple_1985; @founargiotakis_periodic_1989; @barbanis_escape_1990; @babyuk_hydrodynamic_2003].
The nonlinear Hamiltonian systems considered here have an underlying
Hénon-Heiles type potential with the simplest form of nonlinearity, and
show regular, quasi-periodic, and chaotic trajectories along with
bifurcations of periodic orbits. A Hénon-Heiles type potential has a
well with bottlenecks connecting the region of bounded motion (trapped
region) to unbounded motion (escape off to infinity), and have
rotational symmetry. In addition, these Hénon-Heiles type potentials are
studied as first benchmark nonlinear systems in applying new phase space
transport methods to astrophysical and molecular motion. In this
article, we will present verification of a method that uses trajectory
diagnostic on a low dimensional surface for revealing the phase space
structures in 4 or more dimensions.</p>

<p>Conservative dynamics on an open potential well has received
considerable attention because the phase space structures, normally
hyperbolic invariant manifolds (NHIM) and its invariant manifolds,
explain the intricate fractal structure of ionization
rates [@mitchell_geometry_2003_I; @mitchell_geometry_2003_II; @mitchell_chaos-induced_2004].
Furthermore, the discrepancies in observed and predicted ionization
rates in atomic systems has also been explained by accounting for the
topology of the phase space structures. These have been connected with
the breakdown of ergodic assumption that is the basis for using
ionization and dissociation rate
formulae [@de_leon_intramolecular_1981]. This rich literature on chaotic
escape of electrons from atoms sets a precedent for applying new methods
for finding NHIM and its invariant manifolds in Hamiltonian with open
potential wells
 [@mitchell_analysis_2004; @mitchell_chaos-induced_2004; @mitchell_nonlinear_2009; @mitchell_structure_2007; @wang_photoionization_2010].</p>

<p>As we noted earlier, trajectory diagnostic methods which can probe phase
space to detect the high dimensional invariant manifolds have potential
to be of use in many degrees-of-freedom models. One such method is the
Lagrangian descriptors (LDs) that can reveal phase space structures by
encoding geometric property of trajectories (such as, phase space arc
length, configuration space distance or displacement, cumulative action
or kinetic energy) initialised on a two dimensional
surface [@madrid2009; @mendoza2010; @mancho2013; @lopesino2017]. The
method was originally developed in the context of Lagrangian transport
in time-dependent two dimensional fluid mechanics. However, it has also
been successful in locating transition state trajectory in chemical
reactions [@balibrea2016lagrangian; @craven2017lagrangian; @junginger2016lagrangian].
Besides, also being applicable to both Hamiltonian and non-Hamiltonian
systems, as well as to systems with arbitrary time-dependence such as
stochastic and dissipative forces, and geophysical data from satellite
and numerical
simulations [@amism11; @mendoza2014; @ggmwm15; @lopesino2017; @ramos2018].</p>

<p>The method of Lagrangian descriptor (LD) is straightforward to implement
computationally and it provides a “high resolution” method for exploring
the influence of high dimensional phase space structure on trajectory
behaviour. The method of LD takes an <em>opposite</em> approach to that of
classical Lyapunov exponent type calculations by emphasizing the initial
conditions of trajectories, rather than their advected locations that is
involved in calculating normalized rate of divergence. This is achieved
by considering a two dimensional section of the full phase space and
discretizing with a dense grid of initial conditions. Even though the
trajectories wander off in the phase space, as the initial conditions
evolve in time, there is no loss in resolution of the two dimensional
section. In contrast to inferring the phase space structures from
Poincaré sections, LD plots do not suffer from loss of resolution since
the affects of the structure are encoded in the initial conditions and
there is no need for the trajectory to return to the section. Our
objective is to clarify the use of Lagrangian descriptors as a
diagnostic on two dimensional sections of high dimensional phase space
structures. This diagnostic is also meant to be used as the preliminary
step in computing the NHIM, their stable and unstable manifolds using
other computational
means [@junginger2016transition; @bardakcioglu2018; @ezra_2018]. In this
article, we will present the method’s capability to detect the high
dimensional phase space structures such as the NHIM, their stable, and
unstable manifolds in 2 and 3 DoF Hamiltonian systems.</p>

<h2 id="models-and-method">Models and Method</h2>

<h2 id="secmodel_prob_2dofsecmodel_prob_2dof-labelsecmodel_prob_2dofmodel-system-coupled-harmonic-2-dof-hamiltonian">[[sec:model_prob_2dof]]{#sec:model_prob_2dof label=”sec:model_prob_2dof”}Model system: coupled harmonic 2 DoF Hamiltonian</h2>

<p>As pointed out in the Introduction, our focus is to adopt a
well-understood model system which is a 2 degrees-of-freedom coupled
harmonic oscillator with the Hamiltonian <script type="math/tex">% <![CDATA[
\begin{aligned}
\mathcal{H}(x,y,p_x,p_y) =& T(p_x, p_y) + V_{\rm B}(x,y) \\ 
=& \frac{1}{2}p_x^2 + \frac{1}{2}p_y^2 + \frac{1}{2}\omega_x^2 x^2 + \frac{1}{2}\omega_y^2 y^2 +
\delta x y^2  
\end{aligned}
\label{eqn:Hamiltonian_Barbanis} %]]></script> where $\omega_x, \omega_y, \delta$
are the harmonic oscillation frequencies of the $x$ and $y$
degree-of-freedom, and the coupling strength, respectively. We will fix
the parameters as $\omega_x 
= 1.0, \omega_y = 1.1, \delta = -0.11$ in this study. The two
degrees-of-freedom potential is also referred to as <em>Barbanis</em>
potential, and has been investigated as a model of galactic
motion ([@contopoulos1970; @barbanis_isolating_1966]), dynamical
tunneling and molecular spectra in physical
chemistry ([@heller1980; @davis1981; @martens1987]), structural
mechanics and ship capsize ([@ThDe1996; @NaRo2017]).</p>

<p>The equilibria of the Hamiltonian vector field are located at
<script type="math/tex">\left(-\frac{\omega_y^2}{2\delta}, \pm 
\frac{1}{\sqrt{2}}\frac{\omega_x \omega_y}{\delta}, 0, 0 \right) \qquad \text{and}  \qquad \left(0, 
0, 0, 0 \right)</script> and are at total energy
$E_c = \frac{\omega_x^2 \omega_y^4}{8 \delta^2}$ and $0$ respectively.
The energy of the two index-1 saddles (as defined and shown in
App. <a href="#ssect:linear">5.2.1</a>{reference-type=”ref”
reference=”ssect:linear”}) located at positive and negative
y-coordinates and positive x-coordinate for $\delta &lt; 0$ will be
referred to as <em>critical energy</em>, $E_c$. In our discussion, we will
refer to the total energy of a trajectory or initial condition in terms
of the excess energy, $\Delta E = E_c - e$, which can be negative or
positive to denote energy below or above the critical energy. For the
parameters used in this study, the index-1 saddle equilibrium points are
located at $\left( 5.5, \pm 7.071, 0, 
0 \right)$ and have energy, $E_c = 15.125$.</p>

<p>The contours of the coupled harmonic 2 DoF potential energy function in
 <a href="#eqn:Hamiltonian_Barbanis">[eqn:Hamiltonian_Barbanis]</a>{reference-type=”eqref”
reference=”eqn:Hamiltonian_Barbanis”} is shown in
Fig. <a href="#fig:pes_cont_Barbanis">[fig:pes_cont_Barbanis]</a>{reference-type=”ref”
reference=”fig:pes_cont_Barbanis”} along with the 3D view of the
surface. We note here that the potential has steep walls for $x &lt; 0$
when $\delta &lt; 0$ and steep drop-off beyond the bottlenecks around the
index-1 saddles. This leads to unphysical motion in the sense of
trajectories approaching $-\infty$ with ever increasing acceleration
even for finite values of the configuration space
coordinates [@brumer_variational_1976].</p>

<p>In
Fig. <a href="#fig:hills_region_Barbanis">[fig:hills_region_Barbanis]</a>{reference-type=”ref”
reference=”fig:hills_region_Barbanis”} we show the <em>Hill’s region</em>, as
defined in App. <a href="#ssect:coupled_2dof">5</a>{reference-type=”ref”
reference=”ssect:coupled_2dof”}, for the model
system <a href="#eqn:Hamiltonian_Barbanis">[eqn:Hamiltonian_Barbanis]</a>{reference-type=”eqref”
reference=”eqn:Hamiltonian_Barbanis”}. It is important to note here that
even though Hill’s region is shown on the configuration space, it
captures the dynamical picture, that is the <em>phase space perspective</em>,
of the Hamiltonian. This visualization of the energetically accessible
and forbidden realm is the first step towards introducing
two-dimensional surfaces to explore trajectory behavior. The complete
description of the unstable periodic orbit and its invariant manifolds
is described in App. <a href="#ssect:tube_mani">5.1</a>{reference-type=”ref”
reference=”ssect:tube_mani”} along with the visualization in the 3D
space.</p>

<p><img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/pes_cont_Barbanis.png" alt="" />{width=”30.00000%”}\ <img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/pes_cont_Barbanis_3D.png" alt="" />{width=”25.00000%”}\ <img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/Hills_region_Barbanis.png" alt="" />{width=”40.00000%”}</p>

<p>Fig. 1. (a) Potential energy function underlying the coupled harmonic Hamiltonian~\eqref{eqn:Hamiltonian_Barbanis} as isopotential contour and surface. The index-1 saddles are shown as red crosses in both the plots. (b) Hill’s region for energy below and above the energy of the index-1 saddle. Parameters used are $\omega_x = 1.0, \omega_y = 1.1, \delta = -0.11$.</p>

<p>Since this model system is conservative 2 DoF Hamiltonian, that is the
phase space is $\mathbb{R}^4$, the energy surface is three dimensional,
the dividing surface is two dimensional, and the normally hyperbolic
invariant manifold (NHIM), referred to as the unstable periodic orbit,
is one dimensional [@wiggins_role_2016]. Now, if we consider the
intersection of a two dimensional surface with the three-dimensional
energy surface, we would obtain the one-dimensional energy boundary on
the surface of section. We will focus our study by using the
isoenergetic two-dimensional surface</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
%    U_{V, +} &= \left\{(y,p_y) \; | \; x = 0, \; p_x(y,p_y;e) > 0 \right\} , \qquad \text{motion 
%to the right}  \label{eqn:sos_U_Vp} \\
%    U_{V, -} &= \left\{(y,p_y) \; | \; x = 0, \; p_x(y,p_y;e) < 0 \right\} , \qquad \text{motion 
%to the left}  \label{eqn:sos_U_Vm} \\
    U_{xp_x, +} &= \left\{(x,y,p_x,p_y) \; | \; y = 0, \; p_y(x,y,p_x;e) > 0 \right\} 
    \label{eqn:sos_Uxpx} 
%    U_{H, -} &= \left\{(x,p_x) \; | \; y = 0, \; p_y(x,p_x;e) < 0 \right\} , \qquad \text{motion 
%to the bottom}  \label{eqn:sos_U_Hm}
\end{aligned} %]]></script>

<p>where the sign of
the momentum coordinate enforces a directional crossing of the surface.
Due to the form of the vector
field <a href="#eqn:two_dof_Barbanis">[eqn:two_dof_Barbanis]</a>{reference-type=”eqref”
reference=”eqn:two_dof_Barbanis”} and choice of $\delta &lt; 0$, this
directionality condition implies motion towards positive $y$-coordinate.</p>

<p>In this article, detecting the phase space structures will constitute
finding the intersection of the NHIM and its invariant manifolds with a
two dimensional surface (for example,
Eqn. <a href="#eqn:sos_Uxpx">[eqn:sos_Uxpx]</a>{reference-type=”eqref”
reference=”eqn:sos_Uxpx”}).</p>

<h3 id="sec:model_prob_3dof">Model system: coupled harmonic 3 DoF Hamiltonian</h3>

<p>The next higher dimensional model system to consider is the coupled
harmonic potential in 3 dimensions and underlying a 3 degrees-of-freedom
system in [@contopoulos_1994; @farantos_1998]. The Hamiltonian is given
by</p>

<script type="math/tex; mode=display">\begin{split}
\mathcal{H}(x,y,z,p_x,p_y,p_z) =  T(p_x, p_y, p_z) + V_{\rm BC}(x,y,z) = \frac{1}{2}p_x^2 + \frac{1}{2}p_y^2 + \frac{1}{2}p_z^2  + \frac{1}{2}\omega_x^2 x^2 + \frac{1}{2}\omega_y^2 y^2 + \frac{1}{2}\omega_z^2 z^2 - \epsilon x^2y - \eta x^2 z  
\label{eqn:Hamiltonian_BC_3dof}
\end{split}</script>

<p>where $\omega_x^2, \omega_y^2, \omega_z^2, \epsilon, \eta$ are the
parameters related to the coupled harmonic 3 dimensional potential
energy function [@farantos_1998]. In this study, we will fix the
parameters to be
$\omega_x^2 = 0.9, \omega_y^2 = 1.6, \omega_z^2 = 0.4, \epsilon = 
0.08, \eta = 0.01$. The two index-1 saddle equilibria (as shown in the
App. <a href="#sect:coupled_3dof">6</a>{reference-type=”ref”
reference=”sect:coupled_3dof”}) of the Hamiltonian vector
field <a href="#eqn:three_dof_Barbanis">[eqn:three_dof_Barbanis]</a>{reference-type=”eqref”
reference=”eqn:three_dof_Barbanis”} are located at</p>

<script type="math/tex; mode=display">\begin{equation}
\left(\pm \frac{\omega_x\omega_y\omega_z}{\sqrt{2(\epsilon^2\omega_z^2 + \eta^2\omega_y^2)}}, 
\frac{\epsilon \omega_x^2\omega_z^2}{2(\epsilon^2\omega_z^2 + \eta^2\omega_y^2)}, 
\frac{\eta \omega_x^2\omega_y^2}{2(\epsilon^2\omega_z^2 + \eta^2\omega_y^2)},  0, 0, 0 \right) 
\label{eqn:eq_pt_BC_3dof}
\end{equation}</script>

<p>and the total energy is
<script type="math/tex">E_c = \frac{1}{8} \omega_x^2 \frac{\omega_x^2 \omega_y^2 \omega_z^2}{ \left( \epsilon^2 \omega_z^2 + \eta^2 \omega_y^2 \right)}.</script> 
The equilibrium point at
$(0,0,0,0,0,0)$ is stable and has total energy $0$. For the parameters
used in this study, the equilibrium points are located at
$\left( \pm 10.290, 5.294, 2.647, 
0, 0, 0 \right)$ and $\left( 0, 0, 0, 0, 0, 0 \right)$ and have total
energy, $E_c \approx 
23.824$ and $E = 0$, respectively.</p>

<p>We show the isopotential contours of the potential energy function at
fixed value of $z_{\rm eq}$ in
Fig. <a href="#fig:Barbanis_Contopoulos_3dof">[fig:Barbanis_Contopoulos_3dof]</a>{reference-type=”ref”
reference=”fig:Barbanis_Contopoulos_3dof”} along with the Hill’s regions
for positive excess energy, $\Delta E = 6.000$ and projected on the
configuration space coordinates at the equilibrium point.</p>

<p><img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/Barbanis3dof_pes_proj.png" alt="" />{width=”25.00000%”}\ <img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/Barbanis3dof_hills_region_E30_eqpts.png" alt="" />{width=”70.00000%”}
[[fig:Barbanis_Contopoulos_3dof]]{#fig:Barbanis_Contopoulos_3dof
label=”fig:Barbanis_Contopoulos_3dof”}</p>

<p>Fig. 2. (a) Potential energy function underlying the coupled harmonic Hamiltonian~\eqref{eqn:Hamiltonian_BC_3dof} at $z_{\rm eq} = 2.647$ as isopotential contour and surface. (b) Hill’s region for excess energy, $\Delta E = 6.000$ and projected on the configuration space coordinates at the equilibrium point. We note here that the potential energy surface and the Hill’s region is plotted by fixing one of the configuration coordinates at the equilibrium point.</p>

<p>Since this model system is conservative 3 DoF Hamiltonian, that is the
phase space is $\mathbb{R}^6$, the energy surface is five dimensional,
the dividing surface is four dimensional, and the normally hyperbolic
invariant manifold (NHIM) is three dimensional, or precisely 3-sphere,
and its invariant manifolds are four dimensional, or precisely
$\mathbb{R}^1 \times \mathbb{S}^3$ or <em>spherical
cylinders</em> [@wiggins_role_2016]. Now, if we consider the intersection of
a two-dimensional section with the five dimensional energy surface in
$\mathbb{R}^6$, we would obtain the one-dimensional energy boundary on
the surface. We will focus our study near the bottleneck by considering
the isoenergetic two dimensional surfaces</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
    U_{xp_x}^+ = & \left\{ (x, y, z, p_x, p_y, p_z) \; | \; y = y_{\rm eq}, z = z_{\rm eq}, \; p_y = 0, \; p_z(x, y, z, p_x, p_y; e) > 0 \right\} \label{eqn:Barbanis3dof_uxpx}\\
    U_{yp_y}^+ = & \left\{ (x, y, z, p_x, p_y, p_z) \; | \; x = x_{\rm eq}, z = z_{\rm eq}, \; p_x = 0, \; p_z(x, y, z, p_x, p_y; e) > 0 \right\} \label{eqn:Barbanis3dof_uypy}\\
    U_{zp_z}^+ = & \left\{ (x, y, z, p_x, p_y, p_z) \; | \; x = x_{\rm eq}, y = y_{\rm eq}, \; p_x = 0, \; p_y(x, y, z, p_x, p_z; e) > 0 \right\} \label{eqn:Barbanis3dof_uzpz}
%   \label{eqn:Barbanis3dof_sos_near_saddle}
\end{aligned} %]]></script>

<p>In this 3 DoF system, detecting points on the three dimensional NHIM and
four dimensional invariant manifolds will constitute finding their
intersection with the above two dimensional surfaces.</p>

<h2 id="method-lagrangian-descriptor">Method: Lagrangian descriptor</h2>

<p>The Lagrangian descriptor (LD) as presented in Ref.[@madrid2009] is the
arc length of a trajectory calculated on a chosen initial time $t_0$ and
measured for fixed forward and backward integration time, $\tau$. For
continuous time dynamical systems, Ref.[@lopesino2017] gives an
alternative definition of the LD which is useful for proving rigorous
results and can be computed along with the trajectory. It provides a
characterization of the notion of singular features of the LD that
facilitates a proof for detecting invariant manifolds in certain model
situations. In addition, the “additive nature” of this new definition of
LD provides an approach for assessing the influence of each
degree-of-freedom separately. This property was used in
Ref.[@demian2017] to show that Lagrangian descriptor can detect Lyapunov
periodic orbits in the two degrees-of-freedom Hénon-Heiles system. We
will adopt a similar strategy for the aforementioned two and three
degrees-of-freedom autonomous Hénon-Heiles type systems.</p>

<p>In the general setting of a time-dependent vector field
<script type="math/tex">\frac{d\mathbf{x}}{dt} = \mathbf{v}(\mathbf{x},t), \quad \mathbf{x} \in \mathbb{R}^n \;,\; t \in 
\mathbb{R}</script> where $\mathbf{v}(\mathbf{x},t) \in C^r$ ($r \geq 1$) in
$\mathbf{x}$ and continuous in time. The definition of LDs depends on
the initial condition $\mathbf{x}_{0} = \mathbf{x}(t_0)$, on the initial
time $t_0$ (trivial for autonomous systems) and the integration time
$\tau$, and the type of norm of the trajectory’s components, and takes
the form,</p>

<script type="math/tex; mode=display">M_p(\mathbf{x}_{0},t_0,\tau) = \displaystyle{\int^{t_0+\tau}_{t_0-\tau} \sum_{i=1}^{n} 
|\dot{x}_{i}(t;\mathbf{x}_{0})|^p \; dt}
\label{eqn:M_function}</script>

<p>where $p \in (0,1]$ and $\tau \in \mathbb{R}^{+}$ are freely chosen
parameters, and the overdot symbol represents the derivative with
respect to time. It is to be noted here that there are three
formulations of the function $M_p$ in the literature: the arc length of
a trajectory in phase space [@madrid2009], the arc length of a
trajectory projected on the configuration
space  [@junginger2016transition; @junginger2016uncovering; @junginger2017chemical; @junginger2017variational],
and the sum of the $p$-norm of the vector field
components [@lopesino_2015; @lopesino2017]. Although the latter
formulation of the Lagrangian
descriptor <a href="#eqn:M_function">[eqn:M_function]</a>{reference-type=”eqref”
reference=”eqn:M_function”} developed in
Ref. [@lopesino_2015; @lopesino2017] does not resemble the arc length,
the numerical results using either of these forms have been shown to be
in agreement and promise of predictive capability in geophysical
flows [@amism11; @mendoza2014; @ggmwm15; @ramos2018]. The formulation we
adopt here is motivated by the fact that this allows for proving
rigorous result, which we will discuss in the next section, connecting
the singular features and minimum in the LD plots with NHIM and its
stable and unstable manifolds. It follows from the result that</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
\mathcal{W}^s(\mathbf{x}_0, t_0) & = \text{\rm argmin} \; \mathcal{L}^{(f)}(\mathbf{x}_0, t_0, 
\tau) \\
\mathcal{W}^u(\mathbf{x}_0, t_0) & = \text{\rm argmin} \; \mathcal{L}^{(b)}(\mathbf{x}_0, t_0, \tau)
\end{aligned} %]]></script>

<p>where the stable and unstable manifolds
($\mathcal{W}^s(\mathbf{x}_0, t_0)$ and $\mathcal{W}^u(\mathbf{x}_0, t_0)$) denote the invariant manifolds at
intial time $t_0$ and $\text{\rm argmin} \; (\cdot)$ denotes the
argument that minimizes the function
$\mathcal{L}^{(\cdot)}(\mathbf{x}_0, t_0, \tau)$ in forward and backward
time, respectively. In addition, the coordinates on the NHIM,
$\mathcal{M}(\mathbf{x}_0, t_0)$ at time $t_0$ is given by the
intersection $\mathcal{W}^s(\mathbf{x}_0, t_0)$ and
$\mathcal{W}^u(\mathbf{x}_0, t_0)$ of the stable and unstable manifolds,
and thus given by</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
\mathcal{M}(\mathbf{x}_0, t_0) & = \text{\rm argmin} \; \left( \mathcal{L}^{(f)}(\mathbf{x}_0, t_0, 
\tau) + \mathcal{L}^{(b)}(\mathbf{x}_0, t_0, \tau) \right) \\
& = \text{\rm argmin} \; 
\mathcal{L}(\mathbf{x}_0, t_0, \tau) 
\end{aligned} %]]></script>

<p>In applying the LD method to nonlinear systems, one observes multiple
minima and singularities that can lead to trouble with isolating the one
minima due to the NHIM and the ones due to its invariant manifolds.
Since, as we integrate initial conditions on an isoenergetic two
dimensional surface such as
$U_{xp_x}^+$ <a href="#eqn:sos_Uxpx">[eqn:sos_Uxpx]</a>{reference-type=”eqref”
reference=”eqn:sos_Uxpx”}, almost all trajectories that escape to
infinity get integrated for the entire time interval and result in
numerical overflow of the function M
value <a href="#eqn:M_function">[eqn:M_function]</a>{reference-type=”eqref”
reference=”eqn:M_function”} and show up as NaN. This can, however, be
avoided by integrating for shorter time interval but this will vary for
different locations of a surface. Thus, leading to trouble in locating
the point with minimum and singularity in LD contour map that correspond
to NHIM and its invariant manifolds.</p>

<p>This computational issue has been addressed in recent efforts to locate
transition state trajectory in driven and 3 degrees-of-freedom chemical
reaction
dynamics [@craven2017lagrangian; @craven2016deconstructing; @craven2015lagrangian].
It has been noted that computing fixed integration time Lagrangian
descriptor (LD) leads to two potential issues:</p>

<p>1. Bounded trajectories will show global recrossings of the barrier as
predicted by Poincaré recurrrence theorem. The recrossings will show
multiple minima and singularities (as in
Fig. <a href="#fig:psect_lag_desc_Barbanis">[fig:psect_lag_desc_Barbanis]</a>{reference-type=”ref”
reference=”fig:psect_lag_desc_Barbanis”}(d-f)) in the LD plot which
obscures locating the actual NHIM.</p>

<p>2. The trajectories that escape the potential well will leave with ever
increasing acceleration, if the potential energy surface opens out to
infinity. The trajectories with NaN LD values will render the contour
map flat which again obscures locating the NHIM.</p>

<p>To circumvent these issues, a heuristic that has been adopted in the
literature is to calculate LD values only until a trajectory remains
inside the barrier region. The immediate result is the initial condition
on an invariant manifold will have a maxima in the LD values because of
being integrated for the full integration time (preselected) interval.</p>

<p>Thus, the
formulation <a href="#eqn:M_function">[eqn:M_function]</a>{reference-type=”eqref”
reference=”eqn:M_function”} is modified as</p>

<script type="math/tex; mode=display">M_p(\mathbf{x}_{0},t_0,\tau^{\pm}) = \displaystyle{\int^{t_0+\tau^+}_{t_0-\tau^-} \sum_{i=1}^{n} 
    |\dot{x}_{i}(t;\mathbf{x}_{0})|^p \; dt}
\label{eqn:M_function_var}</script>

<p>where the integration time interval depends on a trajectory and given by</p>

<script type="math/tex; mode=display">\tau^{\pm}(\mathbf{x}_0) = \min\left(\tau, t\vert_{|\mathbf{x}(t)| > q_s} \right)
\label{eqn:var_time_qs}</script>

<p>where $q_s$ defines a domain, called the
<em>saddle region</em>, in the configuration space around the saddle. We note
here that the only initial condition that gets integrated for the
entrire $\tau$ time units in forward and backward time is the one on the
NHIM. In addition, the coordinates on the NHIM,
$\mathcal{M}(\mathbf{x}_0, t_0)$, at time $t_0$ is given by
<script type="math/tex">% <![CDATA[
\begin{aligned}
\mathcal{M}(\mathbf{x}_0, t_0) & = \text{\rm argmax} \; \left( \mathcal{L}^{(f)}(\mathbf{x}_0, t_0, 
\tau) + \mathcal{L}^{(b)}(\mathbf{x}_0, t_0, \tau) \right) \\
& = \text{\rm argmax} \; \mathcal{L}(\mathbf{x}_0, t_0, \tau) 
\end{aligned} %]]></script> This is also a familiar from a dynamical systems
perspective where the literature on average exit times to locate
invariant sets has been discussed for the symplectic maps
(see [@meiss_average_1997] and related references). However, the
connection between features in exit times and LD contour maps is not the
focus of this study and will be deferred as related future work.</p>

<h2 id="results">Results</h2>

<p>We begin by noting that two-dimensional Poincaré surface of section have
sufficient dimensionality to capture trajectories on a three dimensional
energy surface, however for high dimensional systems trajectories can go
“around” the two dimensional surface. One approach available in the
literature is to use high dimensional Poincaré sections which can
“catch” trajectories but are hard to visualize on paper or in the
virtual 3D space. Even when gets around this issue, using suitable
projective geometry, the fact that the qualitative analysis based on
Poincaré sections depends on trajectories returning to this surface can
not be circumvented since trajectories on and inside the spherical
cylinders will not return to the Poincaré surface of section.</p>

<p><img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/Barbanis2dof_psect_finalT1500_E15-000_E15-125_E15-250.png" alt="" />{width=”80.00000%”} 
<img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/lag_desc_Barbanis_finalT1500_E15-000_E15-125_E15-250_x-px_tau50.png" alt="" />{width=”80.00000%”}</p>

<p>Fig. 3. <strong>Top row:</strong> Poincar'e surface of section, $U_{xp_x}$~\eqref{eqn:sos_Uxpx}, at excess energy (a) $\Delta E = -0.125$, (b) $\Delta E = 0.000$, (c) $\Delta E = 0.125$ where the intersection of the surface of section with the energy surface is shown in green. <strong>Bottom row:</strong> Lagrangian descriptor on the surface of section, $U_{xp_x}$~\eqref{eqn:sos_Uxpx}, for the excess energies (d) $\Delta E = -0.125$, (e) $\Delta E = 0.000$, (f) $\Delta E = 0.125$ and the integration time $\tau = 50$. The intersection of the surface of section with the cylindrical manifolds of the NHIM \textemdash unstable periodic orbit for this system \textemdash associated with the index-1 saddle equilibrium point in the bottleneck is shown in cyan (stable) and magenta (unstable) curves. The magenta and cyan curves in $p_x &gt; 0$ correspond to the invariant manifolds of unstable periodic orbit at $y &gt; 0$ index-1 saddle, and the ones in $p_x &lt; 0$ correspnd to the invariant manifolds of unstable periodic orbit at $y &lt; 0$ index-1 saddle.</p>

<h2 id="coupled-harmonic-2-dof-system">Coupled harmonic 2 DoF system</h2>

<p>As discussed in aforementioned
literature [@madrid2009; @lopesino2017; @demian2017], points with
minimum Lagrangian descriptor (LD) values and singularity are on the
invariant manifolds. In addition, LD plots show dynamical correspondence
with Poincaré sections (in the sense that regions with regular and
chaotic dynamics are distinct in both Poincaré section and LD plots)
while also depicting the geometry of manifold
intersections [@demian2017; @lopesino2017; @garcia-garrido_2018]. This
correspondence in the LD features and Poincaré section is confirmed in
Fig. <a href="#fig:psect_lag_desc_Barbanis">[fig:psect_lag_desc_Barbanis]</a>{reference-type=”ref”
reference=”fig:psect_lag_desc_Barbanis”} where we show the Poincaré
surface of section
Eqn. <a href="#eqn:sos_Uxpx">[eqn:sos_Uxpx]</a>{reference-type=”eqref”
reference=”eqn:sos_Uxpx”} of trajectories and LD contour maps on the
same isoenergetic two-dimensional surface for negative and positive
excess energies. It can be seen that the chaotic dynamics as marked by
the sea of points in Poincaré section is revealed as the tangle of
invariant manifolds which are points of minima and singularity in the LD
plots. As shown by the one dimensional slices of the LD plots, there are
multiple such minima and singularities and as the excess energy is
increased to positive values, there are regions of discontinuities along
the one dimensional slice. Next, as the energy is increased and the
bottleneck opens at critical energy $E_c$, trajectories that leave the
potential well and do not return to the surface of section are not
observed on the Poincaré section while the LD contour maps clearly
identifies these regions as discontinuities in the LD values. These
regions lead to escape because they are inside the cylindrical manifolds
of the unstable periodic orbit associated with the index-1 saddle
equilibrium point [@NaRo2017]. These regions on the isoenergetic
two-dimensional surface are also referred to as <em>reactive islands</em> in
chemical reaction dynamics [@DeLeon1992; @DeMeTo1991; @DeMeTo1991a]. The
escape regions or reactive islands that appear over the integration time
interval can also be identified by using the forward and backward LD
contour maps where these regions appear as discontinuities. In
Fig. <a href="#fig:psect_lag_desc_Barbanis">[fig:psect_lag_desc_Barbanis]</a>{reference-type=”ref”
reference=”fig:psect_lag_desc_Barbanis”}(f), we show these for
$\Delta E = 
0.125$ and $\tau = 50$ along with the intersection of the cylindrical
manifolds’ intersections that are computed using differential correction
and numerical continuation. The detailed comparison and extension to
high dimensional systems is not the focus of this study and will be
discussed in forthcoming work. Thus LD maps also provide a quick and
reliable approach for detecting regions that will lead to escape within
the observed time, or in the computational context, the integration
time.</p>

<p>To detect the NHIM  in this case, unstable periodic orbit  associated
with the index-1 saddles (marked by cross in
Fig. <a href="#fig:pes_cont_Barbanis">[fig:pes_cont_Barbanis]</a>{reference-type=”ref”
reference=”fig:pes_cont_Barbanis”}), we define an isoenergetic two
dimensional surface that is parametrized by the $y$-coordinate and
placed near the $x$-coordinate of the saddle equilibrium that has the
negative $y$-coordinate. This can be expressed as a parametric two
dimensional surface</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
%  U_{xy}^+ = & \left\{(x,y,p_x,p_y) \; | \; p_x = 0, \; p_y(x,y;e) > 0 \right\}, \\
U_{xp_x}^+(k) = & \left\{(x,y,p_x,p_y) \, | \, y = k, p_y(x,y,p_x;e) > 0 \right\} 
\label{eqn:sos_xpx_k}
%  U_{yp_y}^+ = & \left\{(x,y,p_x,p_y) \; | \; x = k_x, \; p_y(x,y,p_x;e) > 0 \right\},
\end{aligned} %]]></script>

<p>for total energy, $e$, which is above the critical energy, $E_c$, $k$ is
the $y$-coordinate. The variable integration time LD contour maps are
shown in
Fig. <a href="#fig:Barbanis2dof_M1500x1500_E15-250">[fig:Barbanis2dof_M1500x1500_E15-250]</a>{reference-type=”ref”
reference=”fig:Barbanis2dof_M1500x1500_E15-250”} along with the
projection of the low dimensional
slices <a href="#eqn:sos_xpx_k">[eqn:sos_xpx_k]</a>{reference-type=”eqref”
reference=”eqn:sos_xpx_k”} in the configuration space and the NHIM. The
points on NHIM, which is an unstable periodic orbit for 2 DoF, on this
surface is the coordinate with maximum (for variable integration time)
LD value. The full visualization of the NHIM as the black ellipse,
$\mathbb{S}^1$, is in
Fig. <a href="#fig:Barbanis2dof_M1500x1500_E15-250">[fig:Barbanis2dof_M1500x1500_E15-250]</a>{reference-type=”ref”
reference=”fig:Barbanis2dof_M1500x1500_E15-250”}(d) and has been
computed using differential correction and numerical continuation
(details in App. <a href="#ssect:tube_mani">5.1</a>{reference-type=”ref”
reference=”ssect:tube_mani”}) and shows clearly that points on this
unstable periodic orbit are detected by the LD contour map.</p>

<p><img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/Barbanis2dof_M1500x1500_E15-250_xpx_yneg70e-1.png" alt="" />{width=”24.00000%”}\ <img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/Barbanis2dof_M1500x1500_E15-250_xpx_yneg71e-1.png" alt="" />{width=”24.00000%”}\ <img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/Barbanis2dof_M1500x1500_E15-250_xpx_yneg72e-1.png" alt="" />{width=”24.00000%”}\ <img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/Barbanis2DoF_UPO_M1500x1500_E15-250_xpxy_variable-time-exit-saddle-region.png" alt="" />{width=”24.00000%”}</p>

<p>Fig. 4. Lagrangian descriptor computed for variable integration time on two dimensional slices~\eqref{eqn:sos_xpx_k} near the bottleneck that detect the NHIM and its invariant manifolds associated with the index-1 saddle. The two dimensional surfaces are shown in the top figure in (d) projected as orange lines on the configuration space and the unstable periodic orbit as black line connecting the isopotential contour corresponding to $\Delta E = 0.125$ with the Hill’s region shown in grey. The two dimensional slices represent low dimensional probe of the unstable periodic orbit and the movie of a rotating view can be found <a href="https://youtu.be/Ai65ULLlljc">here</a>.</p>

<h3 id="coupled-harmonic-3-dof-system">Coupled harmonic 3 DoF system</h3>

<p>The Lagrangian descriptor based approach for detecting NHIM in 2 DoF
system can now be applied to the 3 DoF
system <a href="#eqn:Hamiltonian_BC_3dof">[eqn:Hamiltonian_BC_3dof]</a>{reference-type=”eqref”
reference=”eqn:Hamiltonian_BC_3dof”}. On the five dimensional energy
surface, the phase space structures such as the NHIM and its invariant
manifolds are three and four dimensional,
respectively [@wiggins_role_2016]. As noted earlier, direct
visualization techniques will fall short in 4 or more DoF systems even
if they are successful in 2 and 3 DoF. So, LD based approach can be used
to detect points on a NHIM and its invariant manifolds using low
dimensional probe which are based on trajectory diagnostic on an
isoenergetic two dimensional surface.</p>

<p>It is to be noted that the increase in phase space dimension, leads to a
polynomial scaling in the number of coordinate pairs (that is
$2N(2N-1)(N-1)$ coordinate pairs for $N$ DoF system) and is thus,
impractical to present the procedure on all the combination of
coordinates. We will present the results for the three configuration
space coordinates by combining each with its corresponding momentum
coordinate.</p>

<p>On these isoenergetic surfaces, we compute the variable integration time
Lagrangian descriptor for small excess energy, $\Delta E \approx 0.176$,
or total energy $E = 24.000$, and show the contour maps in
Fig. <a href="#fig:Barbanis3dof_M_pxpypz">[fig:Barbanis3dof_M_pxpypz]</a>{reference-type=”ref”
reference=”fig:Barbanis3dof_M_pxpypz”}. The maxima identifying the
points on the NHIM and its invariant manifolds can be visualized using
one dimensional slices for constant momenta. This indicates clearly the
initial conditions in the phase space (points on the isoenergetic two
dimensional surfaces in $\mathbb{R}^6$, for
example <a href="#eqn:Barbanis3dof_uxpx">[eqn:Barbanis3dof_uxpx]</a>{reference-type=”eqref”
reference=”eqn:Barbanis3dof_uxpx”}) that do not leave the saddle region.</p>

<p><img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/Barbanis3dof_M1000x1000_E24_xpx_pz-pos.png" alt="" />{width=”33.00000%”}\ <img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/Barbanis3dof_M1000x1000_E24_ypy_pz-pos.png" alt="" />{width=”33.00000%”}\ <img src="/content/05/finding_nhim_2-3dof_nonlinear/figures/Barbanis3dof_M1000x1000_E24_zpz_py-pos_pzConst.png" alt="" />{width=”33.00000%”}
Fig. 5. Detecting points on the NHIM using variable integration time Lagrangian descriptor on the two dimensional surfaces (a) $U_{xp_x}^+$~\eqref{eqn:Barbanis3dof_uxpx}, (b) $U_{yp_y}^+$~\eqref{eqn:Barbanis3dof_uypy}, and (c) $U_{zp_z}^+$~\eqref{eqn:Barbanis3dof_uzpz} at excess energy $\Delta E \approx 0.176$ or total energy $E = 24.000$. For this energy value, the saddle region, as defined in Eqn.~\eqref{eqn:var_time_qs}, is taken to be $q_s = [9,12] \times [2.5,7.5] \times [1,4]$ and $\tau = 50$.</p>

<h2 id="conclusions">Conclusions</h2>

<p>In this article, we discussed a trajectory diagnostic method as a low
dimensional probe of high dimensional invariant manifolds in 2 and 3 DoF
nonlinear Hamiltonian systems. This trajectory diagnostic — Lagrangian
descriptor (LD) — can represent a geometric property of interest in a
system with escape/transition and features, that is minima or maxima, in
its contour map identify points on the high dimensional invariant
manifolds.</p>

<p>Comparing the points on the NHIM in 2 DoF system obtained using the LD
method with differential correction and numerical continuation, we also
verified the method for a nonlinear autonomous system following our
previous work on decoupled and coupled 2 and 3 DoF linear
system [@naik2019finding]. The results on 3 DoF system are also
congruent with what one expects for an extended problem of the 2 DoF
coupled harmonic potential. In addition, the LD method based detection
of NHIM is simple to implement and quickly provides a lay of the
dynamical land which is a preliminirary step in applying phase space
transport to problems in physics and chemistry. This method can also be
used to set up starting guess for other numerical procedures which rely
on good initial guess or can also be used in conjunction with machine
learning methods for rendering the smooth pieces of
NHIM [@bardakcioglu2018; @feldmaier_invariant_2019].</p>

<h2 id="acknowledgements">Acknowledgements</h2>

<p>We acknowledge the support of EPSRC Grant No.  EP/P021123/1 and ONR
Grant No. N00014-01-1-0769. We would like to thank Dmitry Zhdanov for
stimulating discussions.</p>


            </div>
            <div class="c-textbook__footer" id="textbook_footer">
              
<nav class="c-page__nav">
  

  
</nav>

              <footer>
  <p class="footer">This page was created by <a href="https://github.com/jupyter/jupyter-book/graphs/contributors">The Jupyter Book Community</a></p>
</footer>

            </div>

        </div>
      </main>
    </div>
  </body>
</html>
