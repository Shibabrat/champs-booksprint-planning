<h2 id="statement-of-need">Statement of Need</h2>
<p>In Hamiltonian systems the fundamental phase space structure that partitions dynamically disparate trajectories and mediates transition between multi-stable regions is an invariant manifold. In a 2N dimensional Hamiltonian phase space, the invariant manifold has 2 less dimension than the phase space and is anchored to the normally hyperbolic invariant manifold which has 3 less dimension. This becomes an unstable periodic orbit (UPO) for 2 degrees of freedom or four dimensional phase space <span class="citation" data-cites="wiggins_role_2016">(Wiggins 2016)</span>. Since the UPO forms the basis for partitioning trajectories, hence their computation and stability analysis is the starting point for dynamical systems analysis. UPOsHam is meant to serve this purpose by providing examples of how to implement numerical methods for computing the unstable periodic orbits (UPOs) at any specified total energy as long as their existence is guaranteed. Even though, there is no lack of numerical methods for computing UPOs, we have found that they either lack in reproducibility, or have steep learning curve for using the software, or have been written using closed source software, and at times combination of these. Our aim is to provide an open source package that implements some of the standard methods and shows the results in the context of model problems. This is meant as a starting point to integrate other numerical methods in an open source package such that UPOs computed in dynamical systems papers can be reproduced with minimal tweaking while providing an exploratory environment to learn and develop the underlying methods.</p>
<h2 id="summary">Summary</h2>
<p>This Python package, UPOsHam, is a collection of three methods for computing unstable periodic orbits in Hamiltonian systems that model a diverse array of problems in physical sciences and engineering. The unstable periodic orbits exist in the bottleneck of the equipotential line <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">V(x,y) = E</annotation></semantics></math> and project as lines on the configuration space <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math>. The three methods described below have been implemented for three Hamiltonian systems of the form kinetic plus potential energy and are described in <a href="#examples">:Examples</a>. The scripts are written as demonstration of how to modify and adapt the code for a problem of interest.</p>
<p>The computed unstable periodic orbits using the three methods are compared for a model problem in Figure .</p>
<h3 id="features-available-methods">Features: Available Methods</h3>
<p>In this package, the user has the option to choose between the three methods described below. These are implemented in separate scripts with functions that can be modified to define the total energy (Hamiltonian), potential energy, vector field, Jacobian, variational equations <span class="citation" data-cites="Parker_1989">(Parker and Chua 1989)</span>.</p>
<p><strong>Turning point (TP)</strong></p>
<p>This method is based on finding the UPO by detecting trajectories initialized on the equipotential contour (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">V(x,y) = E</annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">V(x,y)</annotation></semantics></math> is the potetial energy function and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>E</mi><annotation encoding="application/x-tex">E</annotation></semantics></math> is the total energy) that turn in the opposite directions <span class="citation" data-cites="Pollak_1980">(Pollak, Child, and Pechukas 1980)</span>. This method relies on the fact that for Hamiltonians of the form kinetic plus potential energy the UPO is the limiting trajectory that bounces back and forth between the equipotential contour corresponding to the given total energy. So to converge on this limiting trajectory, the turning point method iteratively decreases the gap between the bounding trajectories that turn in the opposite directions. Detection of turning is done using a dot product condition which leads to stalling of the method beyond a certain tolerance (typically <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>10</mn><mrow><mo>−</mo><mn>6</mn></mrow></msup><annotation encoding="application/x-tex">10^{-6}</annotation></semantics></math> in the examples here.)</p>
<p><strong>Turning point based on configuration difference (TPCD)</strong></p>
<p>Based on the turning point approach, we have implemented a <strong>new method</strong> which shows stable convergence and does not rely on the dot product formula. Suppose we have found two initial conditions on a given equipotential contour and they turn in the opposite directions. If the difference in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-coordinates is small (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\approx 10^{-2}</annotation></semantics></math>), the generated trajectories will approach the UPO from either sides. If the difference in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-coordinates is large, we can integrate the Hamilton’s equations for a guess time interval and find the turning point (event using ODE event detection) at which the trajectories bounce back from the far side of the equipotential contour in opposite directions. We choose these two points as our initial guess and the difference of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-coordinates become small now. Without loss of generality, this method can be modified to either pick the difference of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>-coordinates or a combination of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math> coordinates. This choice will depend on the orientation of the potential energy surface’s bottleneck in the configuration space.</p>
<p><strong>Differential correction and numerical continuation (DCNC)</strong></p>
<p>This method is based on small (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\approx 10^{-5}</annotation></semantics></math>) corrections to the initial conditions of an UPO and continuing to desired total energy. The procedure is started from the linear solutions of the Hamilton’s equations and which generates a small amplitude (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\approx 10^{-5}</annotation></semantics></math>) UPO. This is fed into the procedure that calculates correction to the initial condition based on error in the terminal condition of the UPO. This leads to convergence within 3 steps in the sense of the trajectory returning to the initial condition. Once a small amplitude UPO is obtained, numerical continuation increases the amplitude and correspondingly total energy, while a combination of bracketing and bisection method computes the UPO at the desired energy for a specified tolerance <span class="citation" data-cites="naik2019bfinding">(<span class="citeproc-not-found" data-reference-id="naik2019bfinding"><strong>???</strong></span>,<span class="citation" data-cites="Koon2011">[@Koon2011]</span>)</span>.</p>
<h2 id="examples">Examples</h2>
<p>Consider the following two degrees-of-freedom Hamiltonian model where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x, y</annotation></semantics></math> are configuration space coordinates and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>x</mi></msub><mo>,</mo><msub><mi>p</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">p_x,p_y</annotation></semantics></math> are corresponding momenta, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">V(x,y)</annotation></semantics></math> is the potential energy, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">T(x,y)</annotation></semantics></math> is the kinetic energy.</p>
<h3 id="uncoupled-quartic-hamiltonian">Uncoupled quartic Hamiltonian</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="script"><mi>ℋ</mi></mstyle><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><msub><mi>p</mi><mi>x</mi></msub><mo>,</mo><msub><mi>p</mi><mi>y</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mfrac><msubsup><mi>p</mi><mi>x</mi><mn>2</mn></msubsup><mn>2</mn></mfrac><mo>−</mo><mi>α</mi><mfrac><msup><mi>x</mi><mn>2</mn></msup><mn>2</mn></mfrac><mo>+</mo><mi>β</mi><mfrac><msup><mi>x</mi><mn>4</mn></msup><mn>4</mn></mfrac><mo>+</mo><mfrac><mi>ω</mi><mn>2</mn></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>p</mi><mi>y</mi><mn>2</mn></msubsup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
    \mathcal{H}(x,y,p_x,p_y) = \frac{p_x^2}{2} - \alpha \frac{x^2}{2} + \beta \frac{x^4}{4} + \frac{\omega}{2}\left( p_y^2 + y^2 \right)
\end{equation}</annotation></semantics></math></p>
<h3 id="coupled-quartic-hamiltonian">Coupled quartic Hamiltonian</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="script"><mi>ℋ</mi></mstyle><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><msub><mi>p</mi><mi>x</mi></msub><mo>,</mo><msub><mi>p</mi><mi>y</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mfrac><msubsup><mi>p</mi><mi>x</mi><mn>2</mn></msubsup><mn>2</mn></mfrac><mo>−</mo><mi>α</mi><mfrac><msup><mi>x</mi><mn>2</mn></msup><mn>2</mn></mfrac><mo>+</mo><mi>β</mi><mfrac><msup><mi>x</mi><mn>4</mn></msup><mn>4</mn></mfrac><mo>+</mo><mfrac><mi>ω</mi><mn>2</mn></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>p</mi><mi>y</mi><mn>2</mn></msubsup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><mi>ϵ</mi><mn>2</mn></mfrac><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>−</mo><mi>y</mi><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\begin{equation}
    \mathcal{H}(x,y,p_x,p_y) = \frac{p_x^2}{2} - \alpha \frac{x^2}{2} + \beta \frac{x^4}{4} + \frac{\omega}{2}\left( p_y^2 + y^2 \right) + \frac{\epsilon}{2}(x - y)^2
\end{equation}</annotation></semantics></math></p>
<h3 id="dbham">DeLeon-Berne Hamiltonian</h3>
<p>This Hamiltonian has been studied as a model of isomerization of a single molecule that undergoes conformational change <span class="citation" data-cites="Deleon_Berne_1981 DeLeon_Marston_1989">(De Leon and Berne 1981; De Leon and Marston 1989)</span> and exhibits regular and chaotic dynamics relevant for chemical reactions.</p>
<p><span class="math display">$$\begin{equation}
\mathcal{H}(x,y,p_x,p_y) = T(p_x, p_y) + V_{\rm DB}(x, y) = \frac{p_x^2}{2m_A} + \frac{p_y^2}{2m_B} + V_{\rm DB}(x, y)
\end{equation}$$</span><br />
where the potential energy function <span class="math inline">$V_{\rm DB}(x,y)$</span> is</p>
<p><span class="math display">$$\begin{equation}
\begin{aligned}
V_{\rm DB}(x,y) = &amp;  V(x) + V(y) + V(x,y) \\
V(y) = &amp; 4y^2(y^2 - 1) + \epsilon_s \\
V(x) = &amp; D_x\left[ 1 - \exp(-\lambda x) \right]^2 \\
V(x,y) = &amp; 4y^2(y^2 - 1)\left[ \exp(-\zeta \lambda x) - 1 \right]
\end{aligned}
\label{eqn:pot_energy_db}
\end{equation}$$</span></p>
<p>The parameters in the model are <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>A</mi></msub><mo>,</mo><msub><mi>m</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">m_A, m_B</annotation></semantics></math> which represent mass of the isomers, while <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>s</mi></msub><mo>,</mo><msub><mi>D</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon_s, D_x</annotation></semantics></math> denote the energy of the saddle, dissociation energy of the Morse oscillator, respectively, and will be kept fixed in this study, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>,</mo><mi>ζ</mi></mrow><annotation encoding="application/x-tex">\lambda, \zeta</annotation></semantics></math> denote the range of the Morse oscillator and coupling parameter between the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math> configuration space coordinates, respectively.</p>
<h2 id="visualization-unstable-periodic-orbits">Visualization: Unstable periodic orbits</h2>
<figure>
<embed src="allinone_coupled.pdf" /><figcaption>Comparing the TP, TPCD, DCNC methods for the coupled quartic Hamiltonian. </figcaption>
</figure>
<figure>
<embed src="allinone_tpcd.pdf" /><figcaption>Comparing the TPCD method for the three Hamiltonians </figcaption>
</figure>
<h2 id="relation-to-ongoing-research-projects">Relation to ongoing research projects</h2>
<p>We are developing geometric methods of phase space transport in the context of chemical reaction dynamics that rely heavily on identifying and computing the unstable periodic orbits. Manuscript related to the <a href="#dbham">De Leon-Berne model</a> is under preparation.</p>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>We acknowledge the support of EPSRC Grant No. EP/P021123/1 and Office of Naval Research (Grant No. N00014-01-1-0769). The authors would like to acknowledge the London Mathematical Society and School of Mathematics at the University of Bristol for supporting the undergraduate research bursary 2019. We acknowledge contributions from Shane Ross for writing the early MATLAB version of the differential correction and numerical continuation code.</p>
<h2 id="references" class="unnumbered">References</h2>
<div id="refs" class="references">
<div id="ref-Deleon_Berne_1981">
<p>De Leon, Nelson, and B. J. Berne. 1981. “Intramolecular Rate Process: Isomerization Dynamics and the Transition to Chaos.” <em>The Journal of Chemical Physics</em> 75 (7): 3495–3510. <a href="https://doi.org/10.1063/1.442459" class="uri">https://doi.org/10.1063/1.442459</a>.</p>
</div>
<div id="ref-DeLeon_Marston_1989">
<p>De Leon, N, and C. Clay Marston. 1989. “Order in Chaos and the Dynamics and Kinetics of Unimolecular Conformational Isomerization.” <em>The Journal of Chemical Physics</em> 91 (6): 3405–25. <a href="https://doi.org/10.1063/1.456915" class="uri">https://doi.org/10.1063/1.456915</a>.</p>
</div>
<div id="ref-Koon2011">
<p>Koon, W. S., M. W. Lo, J. E. Marsden, and S. D. Ross. 2011. <em>Dynamical systems, the three-body problem and space mission design</em>. Marsden books.</p>
</div>
<div id="ref-Parker_1989">
<p>Parker, T. S., and L. O. Chua. 1989. <em>Practical Numerical Algorithms for Chaotic Systems</em>. New York, NY, USA: Springer-Verlag New York, Inc.</p>
</div>
<div id="ref-Pollak_1980">
<p>Pollak, Eli, Mark S. Child, and Philip Pechukas. 1980. “Classical Transition State Theory: A Lower Bound to the Reaction Probability.” <em>The Journal of Chemical Physics</em> 72 (3): 1669–78. <a href="https://doi.org/10.1063/1.439276" class="uri">https://doi.org/10.1063/1.439276</a>.</p>
</div>
<div id="ref-wiggins_role_2016">
<p>Wiggins, Stephen. 2016. “The Role of Normally Hyperbolic Invariant Manifolds (NHIMs) in the Context of the Phase Space Setting for Chemical Reaction Dynamics.” <em>Regular and Chaotic Dynamics</em> 21 (6): 621–38. <a href="https://doi.org/10.1134/S1560354716060034" class="uri">https://doi.org/10.1134/S1560354716060034</a>.</p>
</div>
</div>
